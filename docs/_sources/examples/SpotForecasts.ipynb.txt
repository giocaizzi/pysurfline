{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Surf forecasts for a Surfline spot\n",
    "\n",
    "`pysurfline` offers a simple interface to get the forecast for any spot listed on Surfline."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Retriving the `spotId` of a Surfline spot"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In order to request the data for the correct spot to the SurflineAPI, we must provide the spot with its `spotID` argument. \n",
    "This can be found easily from the URL of the surfline webpage of each spot.\n",
    "\n",
    "> For example, going to [Anchor Point](https://www.surfline.com/surf-report/anchor-point/5842041f4e65fad6a7708cfd) webpage, the URL is:\n",
    "> \n",
    "> ```https://www.surfline.com/surf-report/anchor-point/5842041f4e65fad6a7708cfd```\n",
    "> \n",
    "> after a few seconds of loading the page, the URL could change to something like this:\n",
    ">\n",
    "> ```https://www.surfline.com/surf-report/anchor-point/5842041f4e65fad6a7708cfd?camId=5fd1e2a2bdd08a3999f23aa4&view=table```\n",
    ">\n",
    "> By examining both URLs, we recognize 5842041f4e65fad6a7708cfd  is actually Anchor Point's `spotId`."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `get_spot_forecasts()` function taks the additional parameters:\n",
    "- `days` *(int)*: the number of days to forecast\n",
    "- `intervalHours` *(int)*: the interval between each forecast"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pysurfline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "spot_forecasts = pysurfline.get_spot_forecasts(\n",
    "    spotId='5842041f4e65fad6a7708cfd',\n",
    "    days=2,\n",
    "    intervalHours=3,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## SpotForecast\n",
    "\n",
    "This data received from the API is unpacked into a `SpotForecasts` object.\n",
    "\n",
    "> To understand the logic behind the Surfline API and subsequent implementation of `pysufline` objects, please refer to [Surfline API Schema](SurflineAPI.md).\n",
    "\n",
    "```python\n",
    "class SpotForecasts:\n",
    "    spotId: int\n",
    "    name: str\n",
    "    waves: List[Wave]\n",
    "    wind: List[Wind]\n",
    "    tides: List[Tides]\n",
    "    weather: List[Weather]\n",
    "    sunlightTimes: List[SunlightTime]\n",
    "```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Anchor Point'"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.name"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Waves"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Wave(timestamp=Time(2023-12-31 23:00:00), probability=60, utcOffset=1, surf=Surf(min=0.9, max=1.5, optimalScore=2, plus=False, humanRelation='Waist to head', raw={'min': 0.90473, 'max': 1.41365}), power=369.76912, swells=[Swell(height=1.23, period=11, impact=1, power=369.76912, direction=303.36, directionMin=295.815, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0)]),\n",
       " Wave(timestamp=Time(2024-01-01 02:00:00), probability=100, utcOffset=1, surf=Surf(min=0.9, max=1.4, optimalScore=2, plus=False, humanRelation='Waist to shoulder', raw={'min': 0.83651, 'max': 1.30705}), power=269.26941, swells=[Swell(height=1.11, period=11, impact=0.5456, power=164.00688, direction=303.43, directionMin=295.91, optimalScore=0), Swell(height=0.72, period=15, impact=0.4544, power=105.26253, direction=304.68, directionMin=297.47, optimalScore=1), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0)]),\n",
       " Wave(timestamp=Time(2024-01-01 05:00:00), probability=100, utcOffset=1, surf=Surf(min=1.2, max=1.8, optimalScore=2, plus=False, humanRelation='Chest to overhead', raw={'min': 1.02848, 'max': 1.607}), power=442.12028, swells=[Swell(height=0.9, period=11, impact=0.4045, power=74.71935, direction=307.33, directionMin=299.905, optimalScore=0), Swell(height=1.19, period=15, impact=0.5955, power=367.40093, direction=302.68, directionMin=295.34000000000003, optimalScore=2), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0)]),\n",
       " Wave(timestamp=Time(2024-01-01 08:00:00), probability=100, utcOffset=1, surf=Surf(min=1.5, max=2.1, optimalScore=2, plus=False, humanRelation='Head to 0.6m overhead', raw={'min': 1.29637, 'max': 2.02557}), power=1036.55914, swells=[Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=1.66, period=14, impact=0.9205, power=1036.4889, direction=303.9, directionMin=296.65, optimalScore=2), Swell(height=0.1, period=7, impact=0.0795, power=0.07024, direction=260.62, directionMin=258.065, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0)]),\n",
       " Wave(timestamp=Time(2024-01-01 11:00:00), probability=100, utcOffset=1, surf=Surf(min=1.5, max=2.1, optimalScore=2, plus=False, humanRelation='Head to 0.6m overhead', raw={'min': 1.36119, 'max': 2.12686}), power=1276.66436, swells=[Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=1.8, period=14, impact=1, power=1276.66436, direction=303.54, directionMin=296.165, optimalScore=2), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0), Swell(height=0, period=0, impact=0, power=0, direction=0, directionMin=0, optimalScore=0)])]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.waves[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Wind\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Wind(timestamp=Time(2023-12-31 23:00:00), utcOffset=1, speed=4.55097, direction=114.47656, directionType='Offshore', gust=4.6808, optimalScore=2),\n",
       " Wind(timestamp=Time(2024-01-01 02:00:00), utcOffset=1, speed=5.88996, direction=126.73413, directionType='Offshore', gust=6.22659, optimalScore=0),\n",
       " Wind(timestamp=Time(2024-01-01 05:00:00), utcOffset=1, speed=1.01431, direction=315.08246, directionType='Onshore', gust=2.3332, optimalScore=2),\n",
       " Wind(timestamp=Time(2024-01-01 08:00:00), utcOffset=1, speed=6.55898, direction=329.82323, directionType='Onshore', gust=6.80379, optimalScore=0),\n",
       " Wind(timestamp=Time(2024-01-01 11:00:00), utcOffset=1, speed=1.63095, direction=175.0945, directionType='Cross-shore', gust=1.9673, optimalScore=2)]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.wind[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Tides"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Tides(timestamp=Time(2023-12-31 23:00:00), utcOffset=1, type='NORMAL', height=1.46),\n",
       " Tides(timestamp=Time(2024-01-01 00:00:00), utcOffset=1, type='NORMAL', height=1.67),\n",
       " Tides(timestamp=Time(2024-01-01 01:00:00), utcOffset=1, type='NORMAL', height=2.03),\n",
       " Tides(timestamp=Time(2024-01-01 02:00:00), utcOffset=1, type='NORMAL', height=2.46),\n",
       " Tides(timestamp=Time(2024-01-01 03:00:00), utcOffset=1, type='NORMAL', height=2.85)]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.tides[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Weather"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Weather(timestamp=Time(2023-12-31 23:00:00), utcOffset=1, temperature=17.34355, condition='NIGHT_CLEAR', pressure=1021),\n",
       " Weather(timestamp=Time(2024-01-01 02:00:00), utcOffset=1, temperature=16.6358, condition='NIGHT_CLEAR', pressure=1020),\n",
       " Weather(timestamp=Time(2024-01-01 05:00:00), utcOffset=1, temperature=16.46528, condition='NIGHT_OVERCAST', pressure=1019),\n",
       " Weather(timestamp=Time(2024-01-01 08:00:00), utcOffset=1, temperature=17.52932, condition='CLEAR', pressure=1021),\n",
       " Weather(timestamp=Time(2024-01-01 11:00:00), utcOffset=1, temperature=19.82248, condition='CLEAR', pressure=1021)]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.weather[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Sunlight Times"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[SunlightTimes(midnight=Time(2023-12-31 23:00:00), midnightUTCOffset=1, dawn=Time(2024-01-01 07:10:40), dawnUTCOffset=1, sunrise=Time(2024-01-01 07:37:07), sunriseUTCOffset=1, sunset=Time(2024-01-01 17:49:27), sunsetUTCOffset=1, dusk=Time(2024-01-01 18:15:55), duskUTCOffset=1),\n",
       " SunlightTimes(midnight=Time(2024-01-01 23:00:00), midnightUTCOffset=1, dawn=Time(2024-01-02 07:10:55), dawnUTCOffset=1, sunrise=Time(2024-01-02 07:37:21), sunriseUTCOffset=1, sunset=Time(2024-01-02 17:50:09), sunsetUTCOffset=1, dusk=Time(2024-01-02 18:16:35), duskUTCOffset=1)]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.sunlightTimes[:]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Get data as *pandas Dataframe*\n",
    "\n",
    "The different `SpotForecasts` attributes can be accessed as pandas DataFrame for easy data manipulation.\n",
    "\n",
    "As default, it will return a dataframe that is a join of the data contained in the single `waves`, `wind`,`weather` attributes.\n",
    "\n",
    "To select data to convert to Dataframe, use a string argument: \n",
    "- `surf` (*Default*)\n",
    "- Attribute name:\n",
    "    - `waves`, \n",
    "    - `wind`, \n",
    "    - `tides`, \n",
    "    - `weather`,\n",
    "    - `sunlightTimes`.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get surf data as a single Dataframe\n",
    "\n",
    "The `surf` Dataframe is a join of the data contained in the `waves`, `wind`, `tides`, `weather` attributes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "# show all columns in HTML\n",
    "import pandas as pd\n",
    "pd.set_option('display.max_columns', None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>timestamp_dt</th>\n",
       "      <th>timestamp_timestamp</th>\n",
       "      <th>probability</th>\n",
       "      <th>utcOffset</th>\n",
       "      <th>surf_min</th>\n",
       "      <th>surf_max</th>\n",
       "      <th>surf_optimalScore</th>\n",
       "      <th>surf_plus</th>\n",
       "      <th>surf_humanRelation</th>\n",
       "      <th>surf_raw_min</th>\n",
       "      <th>surf_raw_max</th>\n",
       "      <th>power</th>\n",
       "      <th>swells_0_height</th>\n",
       "      <th>swells_0_period</th>\n",
       "      <th>swells_0_impact</th>\n",
       "      <th>swells_0_power</th>\n",
       "      <th>swells_0_direction</th>\n",
       "      <th>swells_0_directionMin</th>\n",
       "      <th>swells_0_optimalScore</th>\n",
       "      <th>swells_1_height</th>\n",
       "      <th>swells_1_period</th>\n",
       "      <th>swells_1_impact</th>\n",
       "      <th>swells_1_power</th>\n",
       "      <th>swells_1_direction</th>\n",
       "      <th>swells_1_directionMin</th>\n",
       "      <th>swells_1_optimalScore</th>\n",
       "      <th>swells_2_height</th>\n",
       "      <th>swells_2_period</th>\n",
       "      <th>swells_2_impact</th>\n",
       "      <th>swells_2_power</th>\n",
       "      <th>swells_2_direction</th>\n",
       "      <th>swells_2_directionMin</th>\n",
       "      <th>swells_2_optimalScore</th>\n",
       "      <th>swells_3_height</th>\n",
       "      <th>swells_3_period</th>\n",
       "      <th>swells_3_impact</th>\n",
       "      <th>swells_3_power</th>\n",
       "      <th>swells_3_direction</th>\n",
       "      <th>swells_3_directionMin</th>\n",
       "      <th>swells_3_optimalScore</th>\n",
       "      <th>swells_4_height</th>\n",
       "      <th>swells_4_period</th>\n",
       "      <th>swells_4_impact</th>\n",
       "      <th>swells_4_power</th>\n",
       "      <th>swells_4_direction</th>\n",
       "      <th>swells_4_directionMin</th>\n",
       "      <th>swells_4_optimalScore</th>\n",
       "      <th>swells_5_height</th>\n",
       "      <th>swells_5_period</th>\n",
       "      <th>swells_5_impact</th>\n",
       "      <th>swells_5_power</th>\n",
       "      <th>swells_5_direction</th>\n",
       "      <th>swells_5_directionMin</th>\n",
       "      <th>swells_5_optimalScore</th>\n",
       "      <th>speed</th>\n",
       "      <th>direction</th>\n",
       "      <th>directionType</th>\n",
       "      <th>gust</th>\n",
       "      <th>optimalScore</th>\n",
       "      <th>temperature</th>\n",
       "      <th>condition</th>\n",
       "      <th>pressure</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2023-12-31 23:00:00</td>\n",
       "      <td>1704063600</td>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>0.9</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2</td>\n",
       "      <td>False</td>\n",
       "      <td>Waist to head</td>\n",
       "      <td>0.90473</td>\n",
       "      <td>1.41365</td>\n",
       "      <td>369.76912</td>\n",
       "      <td>1.23</td>\n",
       "      <td>11</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>369.76912</td>\n",
       "      <td>303.36</td>\n",
       "      <td>295.815</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4.55097</td>\n",
       "      <td>114.47656</td>\n",
       "      <td>Offshore</td>\n",
       "      <td>4.68080</td>\n",
       "      <td>2</td>\n",
       "      <td>17.34355</td>\n",
       "      <td>NIGHT_CLEAR</td>\n",
       "      <td>1021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-01-01 02:00:00</td>\n",
       "      <td>1704074400</td>\n",
       "      <td>100</td>\n",
       "      <td>1</td>\n",
       "      <td>0.9</td>\n",
       "      <td>1.4</td>\n",
       "      <td>2</td>\n",
       "      <td>False</td>\n",
       "      <td>Waist to shoulder</td>\n",
       "      <td>0.83651</td>\n",
       "      <td>1.30705</td>\n",
       "      <td>269.26941</td>\n",
       "      <td>1.11</td>\n",
       "      <td>11</td>\n",
       "      <td>0.5456</td>\n",
       "      <td>164.00688</td>\n",
       "      <td>303.43</td>\n",
       "      <td>295.910</td>\n",
       "      <td>0</td>\n",
       "      <td>0.72</td>\n",
       "      <td>15</td>\n",
       "      <td>0.4544</td>\n",
       "      <td>105.26253</td>\n",
       "      <td>304.68</td>\n",
       "      <td>297.470</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5.88996</td>\n",
       "      <td>126.73413</td>\n",
       "      <td>Offshore</td>\n",
       "      <td>6.22659</td>\n",
       "      <td>0</td>\n",
       "      <td>16.63580</td>\n",
       "      <td>NIGHT_CLEAR</td>\n",
       "      <td>1020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-01-01 05:00:00</td>\n",
       "      <td>1704085200</td>\n",
       "      <td>100</td>\n",
       "      <td>1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>1.8</td>\n",
       "      <td>2</td>\n",
       "      <td>False</td>\n",
       "      <td>Chest to overhead</td>\n",
       "      <td>1.02848</td>\n",
       "      <td>1.60700</td>\n",
       "      <td>442.12028</td>\n",
       "      <td>0.90</td>\n",
       "      <td>11</td>\n",
       "      <td>0.4045</td>\n",
       "      <td>74.71935</td>\n",
       "      <td>307.33</td>\n",
       "      <td>299.905</td>\n",
       "      <td>0</td>\n",
       "      <td>1.19</td>\n",
       "      <td>15</td>\n",
       "      <td>0.5955</td>\n",
       "      <td>367.40093</td>\n",
       "      <td>302.68</td>\n",
       "      <td>295.340</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.01431</td>\n",
       "      <td>315.08246</td>\n",
       "      <td>Onshore</td>\n",
       "      <td>2.33320</td>\n",
       "      <td>2</td>\n",
       "      <td>16.46528</td>\n",
       "      <td>NIGHT_OVERCAST</td>\n",
       "      <td>1019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-01-01 08:00:00</td>\n",
       "      <td>1704096000</td>\n",
       "      <td>100</td>\n",
       "      <td>1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2.1</td>\n",
       "      <td>2</td>\n",
       "      <td>False</td>\n",
       "      <td>Head to 0.6m overhead</td>\n",
       "      <td>1.29637</td>\n",
       "      <td>2.02557</td>\n",
       "      <td>1036.55914</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>1.66</td>\n",
       "      <td>14</td>\n",
       "      <td>0.9205</td>\n",
       "      <td>1036.48890</td>\n",
       "      <td>303.90</td>\n",
       "      <td>296.650</td>\n",
       "      <td>2</td>\n",
       "      <td>0.1</td>\n",
       "      <td>7</td>\n",
       "      <td>0.0795</td>\n",
       "      <td>0.07024</td>\n",
       "      <td>260.62</td>\n",
       "      <td>258.065</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>6.55898</td>\n",
       "      <td>329.82323</td>\n",
       "      <td>Onshore</td>\n",
       "      <td>6.80379</td>\n",
       "      <td>0</td>\n",
       "      <td>17.52932</td>\n",
       "      <td>CLEAR</td>\n",
       "      <td>1021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-01-01 11:00:00</td>\n",
       "      <td>1704106800</td>\n",
       "      <td>100</td>\n",
       "      <td>1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2.1</td>\n",
       "      <td>2</td>\n",
       "      <td>False</td>\n",
       "      <td>Head to 0.6m overhead</td>\n",
       "      <td>1.36119</td>\n",
       "      <td>2.12686</td>\n",
       "      <td>1276.66436</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>1.80</td>\n",
       "      <td>14</td>\n",
       "      <td>1.0000</td>\n",
       "      <td>1276.66436</td>\n",
       "      <td>303.54</td>\n",
       "      <td>296.165</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.63095</td>\n",
       "      <td>175.09450</td>\n",
       "      <td>Cross-shore</td>\n",
       "      <td>1.96730</td>\n",
       "      <td>2</td>\n",
       "      <td>19.82248</td>\n",
       "      <td>CLEAR</td>\n",
       "      <td>1021</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         timestamp_dt  timestamp_timestamp  probability  utcOffset  surf_min  \\\n",
       "0 2023-12-31 23:00:00           1704063600           60          1       0.9   \n",
       "1 2024-01-01 02:00:00           1704074400          100          1       0.9   \n",
       "2 2024-01-01 05:00:00           1704085200          100          1       1.2   \n",
       "3 2024-01-01 08:00:00           1704096000          100          1       1.5   \n",
       "4 2024-01-01 11:00:00           1704106800          100          1       1.5   \n",
       "\n",
       "   surf_max  surf_optimalScore  surf_plus     surf_humanRelation  \\\n",
       "0       1.5                  2      False          Waist to head   \n",
       "1       1.4                  2      False      Waist to shoulder   \n",
       "2       1.8                  2      False      Chest to overhead   \n",
       "3       2.1                  2      False  Head to 0.6m overhead   \n",
       "4       2.1                  2      False  Head to 0.6m overhead   \n",
       "\n",
       "   surf_raw_min  surf_raw_max       power  swells_0_height  swells_0_period  \\\n",
       "0       0.90473       1.41365   369.76912             1.23               11   \n",
       "1       0.83651       1.30705   269.26941             1.11               11   \n",
       "2       1.02848       1.60700   442.12028             0.90               11   \n",
       "3       1.29637       2.02557  1036.55914             0.00                0   \n",
       "4       1.36119       2.12686  1276.66436             0.00                0   \n",
       "\n",
       "   swells_0_impact  swells_0_power  swells_0_direction  swells_0_directionMin  \\\n",
       "0           1.0000       369.76912              303.36                295.815   \n",
       "1           0.5456       164.00688              303.43                295.910   \n",
       "2           0.4045        74.71935              307.33                299.905   \n",
       "3           0.0000         0.00000                0.00                  0.000   \n",
       "4           0.0000         0.00000                0.00                  0.000   \n",
       "\n",
       "   swells_0_optimalScore  swells_1_height  swells_1_period  swells_1_impact  \\\n",
       "0                      0             0.00                0           0.0000   \n",
       "1                      0             0.72               15           0.4544   \n",
       "2                      0             1.19               15           0.5955   \n",
       "3                      0             1.66               14           0.9205   \n",
       "4                      0             1.80               14           1.0000   \n",
       "\n",
       "   swells_1_power  swells_1_direction  swells_1_directionMin  \\\n",
       "0         0.00000                0.00                  0.000   \n",
       "1       105.26253              304.68                297.470   \n",
       "2       367.40093              302.68                295.340   \n",
       "3      1036.48890              303.90                296.650   \n",
       "4      1276.66436              303.54                296.165   \n",
       "\n",
       "   swells_1_optimalScore  swells_2_height  swells_2_period  swells_2_impact  \\\n",
       "0                      0              0.0                0           0.0000   \n",
       "1                      1              0.0                0           0.0000   \n",
       "2                      2              0.0                0           0.0000   \n",
       "3                      2              0.1                7           0.0795   \n",
       "4                      2              0.0                0           0.0000   \n",
       "\n",
       "   swells_2_power  swells_2_direction  swells_2_directionMin  \\\n",
       "0         0.00000                0.00                  0.000   \n",
       "1         0.00000                0.00                  0.000   \n",
       "2         0.00000                0.00                  0.000   \n",
       "3         0.07024              260.62                258.065   \n",
       "4         0.00000                0.00                  0.000   \n",
       "\n",
       "   swells_2_optimalScore  swells_3_height  swells_3_period  swells_3_impact  \\\n",
       "0                      0                0                0                0   \n",
       "1                      0                0                0                0   \n",
       "2                      0                0                0                0   \n",
       "3                      0                0                0                0   \n",
       "4                      0                0                0                0   \n",
       "\n",
       "   swells_3_power  swells_3_direction  swells_3_directionMin  \\\n",
       "0               0                   0                      0   \n",
       "1               0                   0                      0   \n",
       "2               0                   0                      0   \n",
       "3               0                   0                      0   \n",
       "4               0                   0                      0   \n",
       "\n",
       "   swells_3_optimalScore  swells_4_height  swells_4_period  swells_4_impact  \\\n",
       "0                      0                0                0                0   \n",
       "1                      0                0                0                0   \n",
       "2                      0                0                0                0   \n",
       "3                      0                0                0                0   \n",
       "4                      0                0                0                0   \n",
       "\n",
       "   swells_4_power  swells_4_direction  swells_4_directionMin  \\\n",
       "0               0                   0                      0   \n",
       "1               0                   0                      0   \n",
       "2               0                   0                      0   \n",
       "3               0                   0                      0   \n",
       "4               0                   0                      0   \n",
       "\n",
       "   swells_4_optimalScore  swells_5_height  swells_5_period  swells_5_impact  \\\n",
       "0                      0                0                0                0   \n",
       "1                      0                0                0                0   \n",
       "2                      0                0                0                0   \n",
       "3                      0                0                0                0   \n",
       "4                      0                0                0                0   \n",
       "\n",
       "   swells_5_power  swells_5_direction  swells_5_directionMin  \\\n",
       "0               0                   0                      0   \n",
       "1               0                   0                      0   \n",
       "2               0                   0                      0   \n",
       "3               0                   0                      0   \n",
       "4               0                   0                      0   \n",
       "\n",
       "   swells_5_optimalScore    speed  direction directionType     gust  \\\n",
       "0                      0  4.55097  114.47656      Offshore  4.68080   \n",
       "1                      0  5.88996  126.73413      Offshore  6.22659   \n",
       "2                      0  1.01431  315.08246       Onshore  2.33320   \n",
       "3                      0  6.55898  329.82323       Onshore  6.80379   \n",
       "4                      0  1.63095  175.09450   Cross-shore  1.96730   \n",
       "\n",
       "   optimalScore  temperature       condition  pressure  \n",
       "0             2     17.34355     NIGHT_CLEAR      1021  \n",
       "1             0     16.63580     NIGHT_CLEAR      1020  \n",
       "2             2     16.46528  NIGHT_OVERCAST      1019  \n",
       "3             0     17.52932           CLEAR      1021  \n",
       "4             2     19.82248           CLEAR      1021  "
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.get_dataframe().head() # \"surf\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Single attribute as DataFrame\n",
    "\n",
    "In order to get a single attribute as a DataFrame, the attribute name must be specified as an argument.\n",
    "- `waves`\n",
    "- `wind`\n",
    "- `weather`\n",
    "- `tides`\n",
    "- `sunlightTimes`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>timestamp_timestamp</th>\n",
       "      <th>timestamp_dt</th>\n",
       "      <th>utcOffset</th>\n",
       "      <th>speed</th>\n",
       "      <th>direction</th>\n",
       "      <th>directionType</th>\n",
       "      <th>gust</th>\n",
       "      <th>optimalScore</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1704063600</td>\n",
       "      <td>2023-12-31 23:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>4.55097</td>\n",
       "      <td>114.47656</td>\n",
       "      <td>Offshore</td>\n",
       "      <td>4.68080</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1704074400</td>\n",
       "      <td>2024-01-01 02:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>5.88996</td>\n",
       "      <td>126.73413</td>\n",
       "      <td>Offshore</td>\n",
       "      <td>6.22659</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>1704085200</td>\n",
       "      <td>2024-01-01 05:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1.01431</td>\n",
       "      <td>315.08246</td>\n",
       "      <td>Onshore</td>\n",
       "      <td>2.33320</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>1704096000</td>\n",
       "      <td>2024-01-01 08:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>6.55898</td>\n",
       "      <td>329.82323</td>\n",
       "      <td>Onshore</td>\n",
       "      <td>6.80379</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>1704106800</td>\n",
       "      <td>2024-01-01 11:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1.63095</td>\n",
       "      <td>175.09450</td>\n",
       "      <td>Cross-shore</td>\n",
       "      <td>1.96730</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index  timestamp_timestamp        timestamp_dt  utcOffset    speed  \\\n",
       "0      0           1704063600 2023-12-31 23:00:00          1  4.55097   \n",
       "1      1           1704074400 2024-01-01 02:00:00          1  5.88996   \n",
       "2      2           1704085200 2024-01-01 05:00:00          1  1.01431   \n",
       "3      3           1704096000 2024-01-01 08:00:00          1  6.55898   \n",
       "4      4           1704106800 2024-01-01 11:00:00          1  1.63095   \n",
       "\n",
       "   direction directionType     gust  optimalScore  \n",
       "0  114.47656      Offshore  4.68080             2  \n",
       "1  126.73413      Offshore  6.22659             0  \n",
       "2  315.08246       Onshore  2.33320             2  \n",
       "3  329.82323       Onshore  6.80379             0  \n",
       "4  175.09450   Cross-shore  1.96730             2  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "spot_forecasts.get_dataframe(\"wind\").head()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "pysurfline",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.18"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
